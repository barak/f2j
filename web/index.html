<html>
<!--  Created by Drew Downey              -->
<!--  Brewed on 2/13/2001 8:59:24 PM      -->

<!*********************************HEAD*********************************************-->
<head>
  <title>Fortran 2 Java(f2j) Project</title>
  <meta name="description" content="Fortran 2 Java(f2j) Project">
  <meta name="keywords" content="f77, blas, netlib, lapack, f2j, icl, fortran, java, compiler, translator">

  <script language = "JavaScript">     <!-- check browser, need this b/c of div tags -->
  function get_browser(){
        if(document.all){ 
           visible = 'visible';
		}else if(document.layers){
		   visible = 'show';
		   }
  }
  function reDo(){                     <!-- reload gets called then window resizes -->
       window.location.reload() 
       window.onresize = reDo;
  }
  </SCRIPT>
</head>

<!*******************************BODY**********************************************-->
<body bgcolor="#FFFFFF" onResize="window.location.reload()" onload="get_browser()" text="#000000" link="red" vlink="red" background="grey_border.gif">
   
   <div id="email" style="position: absolute; left: 145; top: 0; visibility: visible">
         <a href="http://icl.cs.utk.edu"><img src="ICL_logo.jpg" width="455" height="108" align="top"></a>
   </div>
   
   <div id="email" style="position: absolute; left: 620; top: 0; visibility: visible">
         <img src="f2j_logo.jpg">   
   </div>
        
   <div id="email" style="position: absolute; left: 645; top: 90; visibility: visible">
      <a href="mailto:seymour@cs.utk.edu">Keith Seymour<br>[seymour@cs.utk.eu]</a>
   </div>
   
   <div id="title" style="position: absolute; left: 155; top: 135; visibility: visible">
      <h2>Fortran-to-Java Compiler</h2>
   </div>
   
   <div id="menu" style="position: absolute; left: 10; top: 10; visibility: visible">
      <h3>
        <img src="ball.gif"><a href="index.html">Home</a><br><br>
        <img src="ball.gif"><a href="links.html">Links</a><br><br>
        <img src="ball.gif"><a href="downloads.html">Downloads</a><br><br>
        <img src="ball.gif"><a href="mail.html">Mailing List</a><br><br>
        <img src="ball.gif"><a href="paper.html">Papers</a><br><br>
        <img src="ball.gif"><a href="people.html">People</a><br><br>
      </h3>
   </div>
   
   <div id="intro" style="position: absolute; left: 155; top: 170; visibility: visible">
   	  Our primary motivation is to provide numerical linear algebra 
	  software originally written in Fortran as Java class files. The numerical
	  libraries will be distributed as class files produced by a Fortran-to-Java
	  translator, f2j. The f2j translator is a formal compiler that translates
	  programs written using a subset of Fortran77 into a form that may be executed 
	  on  Java virtual machines(JVM). The first priority of f2j is to translate the
	  <a href="http://www.netlib.org/blas">BLAS</a> and <a href="http://www.netlib.org/lapack">LAPACK</a> 
          numerical libraries from their Fortran77 reference source code to
	  Java class files.<br><br>
	  
	  The f2j project is composed of three phases:<br><br> 

         <ol type="1">
            <li>Writing a Fortran front-end capable of lexing and parsing the subset of Fortran necessary to translate BLAS and LAPACK. </li>
            <li>Generating Java source and Jasmin opcode to produce class files for use with a JVM. </li>
            <li>Testing, documenting and distributing the translated BLAS and LAPACK class files. </li>
         </ol>  
      
	 <h3><font color="red">New JLAPACK Release Available on Downloads Page!!!</font></h3>
   
        <img src="example.jpg"><br><br>
	All of the double precision BLAS and LAPACK Fortran source codes have been 
	translated directly to Java sources. Some sample files to examine: <br><br>
        <ul>
           <li><a href="dsymm.f">dsymm.f</a>, a matrix-matrix multiplication subroutine. </li>
           <li>The translated Java source produced by f2java <a href="Dsymm.java">Dsymm.java</a> Dsymm.java was 
           filtered through Percolator using the default formatting options. </li>
           <li>Output class <a href="Xerbla.java">Xerbla.java</a> to display error conditions. </li>
        </ul>	
		
	Jasmin provides a straightfoward method to assemble Java Virtual Machine byte code from a set of assembler 
        instructions identical to instructions emitted by Sun's disassembler. Since Fortran 77 does not specify while loops, 
        these are implemented in BLAS and LAPACK using goto statements, which are supported at the JVM level.<br> 
		
        <ul>
           <li>A simple Fortran source:<a href="loops.f"> loops.f</a></li>
           <li>The Jasmin produced by f2jas:<a href="Loops.j"> Loops.j</a> </li>
        </ul>			
   
        <img src="status_bar.jpg"><br><br>
	  
        <ul>
            <li>Only scalars that are determined to be modified are wrapped in objects. </li>
            <li>Limited support for READ (but not formatted). </li>
            <li>Limited support for WRITE/FORMAT. </li>
            <li>Very basic handling of EQUIVALENCE. </li>
            <li>COMMON now supported. </li>
            <li>Handling of GOTO statements! </li>
            <li>Can now handle passing functions as arguments. </li>
            <li>Elementary loop detection for while loops. </li>
            <li>DATA and SAVE statements are now supported. </li>
            <li>Lexer cleaned up and extended to handle character strings and substrings. </li>
            <li>Source files containing multiple functions/subroutines will now translate. </li>
        </ul>
	Since ANSI Fortran 77 does not specify while loops, all such constructions in the BLAS and LAPACK are implemented 
        with goto statements. The Java Assembler Interface (<a href="http://www.mrl.nyu.edu/~meyer/jvm/">Jasmin</a>) is capable
        of assembling files written in Sun's JVM opcode. Since the JVM has built-in goto branching, Jasmin easily implements all 
        goto statements in the Fortran source. Since we now have a scheme to translate Fortran GOTO statements into Java source code, 
        we have not put much emphasis on the Jasmin code generator. 

      <br><br>However, complex numbers will most likely have to go directly to Jasmin for implementation on the JVM stack. 
      Using the object-oriented methods for complex arithmetic would likely produce unacceptable overhead for large scale 
      numerical problems. Jasmin can be used to translate complex numbers and complex arithmetic operations directly into JVM stack arithmetic. 
      <br>
	  
      <center><h3><u>LAPACK, Linear Algebra Package</u></h3></center>
      Java LAPACK has now completed the testing stage. Some of the main design issues are: <br><br>
      <ul>
         <li>Arrays are being implemented as 1 dimensional in the Java translation. Access is by index arithmetic, 
             using leading dimensions declared in the Fortran source. User interface issues have not yet been resolved</li>
         <li>Certain variables are returned by reference, which has no counterpart in Java. Currently all scalar variables o
             will be wrapped as an object with a single (value) field. This has obvious performance implications, but it is a 
             convenient first step towards getting a working Java implementation of LAPACK. We will certainly be working on optimizations in the future. </li>
         <li>Translation of GOTO statements is done with a post-translation processing step. First, we use f2java to translate 
             the Fortran code to Java. GOTOs are automatically translated as calls to a dummy class. So, GO TO 100 would be translated 
             as Dummy.go_to(100); . The labels in the Fortran source are also translated as calls to the dummy class (for example, the label 100 
             becomes Dummy.label(100); in the Java source). Next we compile the Java file as usual (using javac). We then use a special 
             program to analyze the bytecode and translate the dummy goto calls to real JVM goto instructions. Our tool is based on the 
             bytecode parser in <a href="http://www.extreme.indiana.edu/~ajcbik/JAVAB/">javab</a>, a bytecode parallelizing 
             tool under development at the University of Indiana. </li>
      </ul>

      A general solution for translating Fortran to Java may not be available without using object methods, possibly 
      incurring large performance penalties. Our alternative is to chose those features most important to efficiency in 
      numerical analysis, and direct the translation using the known structure of the BLAS and LAPACK Fortran source
   	  
      <center><h3><u>The BLAS, Basic Linear Algebra Subroutines</center></h3></u>
      <br>Java BLAS is translated from the BLAS Fortran reference source archived at the Netlib numerical software 
      repository. BLAS is composed of three levels of linear algebra operations: 
      <br>
      <ul>
         <li>Level 1 BLAS consists of vector-vector operations such as dot product, etc. </li>
         <li>Level 2 BLAS consists of vector-matrix operations. </li>
         <li>Level 3 BLAS consists of matrix-matrix operations.  </li>
      </ul>
  </div>
</body>
</html>

